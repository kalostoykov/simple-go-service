spec:
  containers:
  - name: golang
    image: golang:1.22.7-alpine3.20
    command:
    - sleep
    args:
    - 99d
  - name: docker
    image: docker:latest
    command:
      - /bin/cat
    tty: true
    volumeMounts:
      - name: dind-certs
        mountPath: /certs
    env:
      - name: DOCKER_TLS_CERTDIR
        value: /certs
      - name: DOCKER_CERT_PATH
        value: /certs
      - name: DOCKER_TLS_VERIFY
        value: 1
      - name: DOCKER_HOST
        value: tcp://localhost:2376
  - name: dind
    image: docker:dind
    securityContext:
      privileged: true
    env:
      - name: DOCKER_TLS_CERTDIR
        value: /certs
    volumeMounts:
      - name: dind-storage
        mountPath: /var/lib/docker
      - name: dind-certs
        mountPath: /certs
  volumes:
    - name: dind-storage
      emptyDir: {}
    - name: dind-certs
      emptyDir: {}